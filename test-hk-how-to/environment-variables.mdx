---
title: "Use environment variables"
description: "사용할 수 있는 시스템 변수와 사용자 정의 환경변수를 설명합니다. API 호출·인증에 활용할 수 있습니다."
---

### Use system variables

서비스에서 자동으로 주입되는 시스템 변수입니다.

| Key                   | Description                                |
| --------------------- | ------------------------------------------ |
| `SELECT_ACCESS_TOKEN` | JWT 토큰 (`프로젝트 > 기본 정보 > JWT_SECRET` 설정 필요) |
| `SELECT_USER_ID`      | 로그인 사용자 ID                                 |
| `SELECT_USER_EMAIL`   | 로그인 사용자 이메일                                |

```yaml
blocks:
  - type: http
    method: GET
    fetchFn: |
      console.log({ params }) // 사용 가능한 모든 키 확인
      return [
        {
          key: 'SELECT_USER_EMAIL',
          value: SELECT_USER_EMAIL,
        },
        {
          key: 'SELECT_USER_ID',
          value: SELECT_USER_ID,
        },
        {
          key: 'SELECT_ACCESS_TOKEN',
          value: SELECT_ACCESS_TOKEN,
        },
      ]
```

### Set user-defined variables (Env)

`Pages → Env` 탭에서 Key-Value 형태로 등록합니다. 환경별(Production / Development)로 구분 설정이 가능합니다.

```yaml
Key: API
Value: http://localhost:9500
```

등록된 Env 변수는 자동으로 `params`에 포함됩니다.

```yaml
blocks:
  - type: http
    method: GET
    fetchFn: |
      console.log({ params })
      return [
        { key: 'API', value: API },
        { key: 'EMAIL', value: SELECT_USER_EMAIL },
      ]
```

출력 예시:

```js
{
  API: "http://localhost:9500",
  SELECT_ACCESS_TOKEN: "eyJhbGciOiJIUzI1NiIs...",
  SELECT_USER_EMAIL: "1015@test.com",
  SELECT_USER_ID: 372
}
```

### Call API with JWT

셀렉트에서 발급한 Token을 서버로 전달합니다. 서버는 동일한 JWT_SECRET으로 req.body.token을 검증할 수 있습니다.

```yaml
blocks:
  - type: http
    method: POST
    fetchFn: |
      const r = await axios({
        url: `${API}/sample-api/wines`,
        method: 'POST',
        data: {
          token: SELECT_ACCESS_TOKEN // 또는 params.SELECT_ACCESS_TOKEN
        }
      })
      return r.data.wines
```

### Set JWT SECRET

`프로젝트 → 기본 정보 → JWT_SECRET`을 설정하면 JWT 토큰이 생성됩니다.

```txt
JWT SECRET: 123
```

검증 예시 ([jwt.io](https://jwt.io)):

- Secret이 일치할 때만 “Valid JWT”로 표시됩니다.

Payload 예시:

```json
{
  "id": 372,
  "email": "1015@test.com",
  "role": "admin",
  "iat": 1766957569,
  "exp": 1766856769
}
```

### Troubleshooting

| Issue                           | Cause                          |
| ------------------------------- | ------------------------------ |
| `SELECT_ACCESS_TOKEN` undefined | `JWT_SECRET` 미설정               |
| `API` undefined                 | Env 값 누락 또는 환경 미선택             |
| 검증 실패                           | 서버와 클라이언트 Secret 불일치           |
| `CORS error`                    | 백엔드 CORS Origin 미등록            |
| 토큰 미도착                          | 프록시/게이트웨이에서 `x-select-jwt` 제거됨 |