---
title: "Use environment variables"
description: "사용할 수 있는 시스템 변수와 사용자 정의 환경변수를 설명합니다. API 호출·인증에 활용할 수 있습니다."
---

### Use system variables

서비스에서 제공하는 시스템 변수입니다.

| Key                   | Description                                |
| --------------------- | ------------------------------------------ |
| `SELECT_ACCESS_TOKEN` | JWT 토큰 (프로젝트 \> 기본 정보 \> JWT_SECRET 설정 필요) |
| `SELECT_USER_ID`      | 로그인 사용자 ID                                 |
| `SELECT_USER_EMAIL`   | 로그인 사용자 이메일                                |

```yaml
blocks:
  - type: http
    method: GET
    fetchFn: |
      return [
        { key: 'USER_EMAIL', value: SELECT_USER_EMAIL },
        { key: 'USER_ID', value: SELECT_USER_ID },
        { key: 'ACCESS_TOKEN', value: SELECT_ACCESS_TOKEN },
      ]
```

### Set user-defined variables (Env)

`Pages → Env` 탭에서 Key-Value 형태로 등록. 환경별(Production/Development)로 구분 가능합니다.

```yaml
Key: API
Value: http://localhost:9500
```

모든 Env 변수는 자동으로 `params`에 포함됩니다.

```yaml
blocks:
  - type: http
    method: GET
    fetchFn: |
      console.log({ params })
      return [
        { key: 'API', value: API },
        { key: 'EMAIL', value: SELECT_USER_EMAIL },
      ]
```

출력 예시:

```js
{
  API: "http://localhost:9500",
  SELECT_ACCESS_TOKEN: "eyJhbGciOiJIUzI1NiIs...",
  SELECT_USER_EMAIL: "1015@test.com",
  SELECT_USER_ID: 372
}
```

### Call API with JWT verification

셀렉트는 API 호출 시 내부적으로 JWT를 서명해 함께 전송합니다. 별도의 `Authorization` 헤더나 인증키가 필요 없습니다.

```yaml
blocks:
  - type: http
    method: GET
    fetchFn: |
      const r = await axios({
        url: `${API}/sample-api/wines`,
        // JWT 토큰은 자동으로 포함되어 전송됨
      })
      return r.data.rows
```

#### Example: Verify token on server

서버는 동일한 `JWT_SECRET`을 사용해 요청의 JWT를 검증합니다. 서명 검증에 성공하면 요청이 셀렉트에서 온 것임을 보장할 수 있습니다.

```js
import jwt from 'jsonwebtoken'

app.get('/sample-api/wines', (req, res) => {
  const token = req.headers['x-select-jwt'] // 셀렉트가 자동 첨부하는 JWT
  const decoded = jwt.verify(token, process.env.JWT_SECRET)
  res.json({ ok: true, user: decoded })
})
```

### Set JWT SECRET

`프로젝트 → 기본 정보 → JWT_SECRET` 설정 시 JWT 토큰이 생성됩니다. 클라이언트와 서버 모두 동일한 Secret을 사용해야 검증이 통과됩니다.

```txt
JWT SECRET: 123
```

검증 예시 ([jwt.io](https://jwt.io)) Secret이 일치할 때만 “Valid JWT”로 표시됩니다.

Payload 예시:

```json
{
  "id": 372,
  "email": "1015@test.com",
  "role": "admin",
  "iat": 1766957569,
  "exp": 1766856769
}
```

### Troubleshooting

| Issue                           | Cause                   |
| ------------------------------- | ----------------------- |
| `SELECT_ACCESS_TOKEN` undefined | `JWT_SECRET` 미설정        |
| `API` undefined                 | Env 값 누락 또는 환경 체크박스 미선택 |
| `401 / 403`                     | 서버 Secret 불일치 또는 토큰 누락  |
| `CORS error`                    | 백엔드 CORS Origin 미등록     |

### Quick check

셀렉트 페이지에서 브라우저 콘솔로 바로 확인하는 방법:

```yaml
blocks:
  - type: http
    method: GET
    fetchFn: |
      console.log({ params }) // 사용 가능한 모든 키 확인
      return params
```